montageDefine("1855034","composer/key-composer",{dependencies:["../core/core","./composer"],factory:function(e,n){var t=e("../core/core").Montage,a=e("./composer").Composer,i="keyPress",s="longKeyPress",o="keyRelease",r=n.KeyComposer=a.specialize({_isLoaded:{value:!1},_shouldDispatchEvent:{value:!1},shouldDispatchLongPress:{value:!1},_longPressTimeout:{value:null},_keyRegistered:{value:!1},_keys:{value:null},keys:{get:function(){return this._keys},set:function(e){this._keyRegistered?(c.defaultKeyManager.unregisterKey(this),this._keys=e,c.defaultKeyManager.registerKey(this)):this._keys=e}},load:{value:function(){this._shouldDispatchEvent&&!this._keyRegistered&&(c.defaultKeyManager.registerKey(this),this._keyRegistered=!0)}},unload:{value:function(){c.defaultKeyManager.unregisterKey(this),this._keyRegistered=!1}},addEventListener:{value:function(e,n,t){var r=this.component;a.addEventListener.call(this,e,n,t),(e==i||e==s||e==o)&&(this._shouldDispatchEvent=!0,e==s&&(this._shouldDispatchLongPress=!0),this._isLoaded?this._keyRegistered||(c.defaultKeyManager.registerKey(this),this._keyRegistered=!0):r&&"function"!=typeof r.addComposer&&(this.element||(this.element=window),this.component.loadComposer(this)))}},constructor:{value:function(){a.constructor.call(this)}},deserializedFromTemplate:{value:function(){var e=this.component;null===this.identifier&&(this.identifier=t.getInfoForObject(this).label),e&&("function"==typeof e.addComposer?e.addComposer(this):this._isLoaded||(this.element||(this.element=window),this.component.loadComposer(this)))}}},{createKey:{value:function(e,n,t){var a=this;return this===r&&(a=new r),t||(t=e.identifier?e.identifier+n.toLowerCase().replace(/[ +]/g).toCapitalized():n.toLowerCase().replace(/[ +]/g)),a.keys=n,a.identifier=t,e.addComposer(a),a}},createGlobalKey:{value:function(e,n,t){var a=this;return this===r&&(a=new r),a.keys=n,a.identifier=t,e.addComposerForElement(a,window),a}}}),l=null,c=t.specialize({_defaultKeyManager:{value:null},_loadingDefaultKeyManager:{value:!1},_keysToRegister:{value:[]},constructor:{value:function(){}},registerKey:{value:function(n){var t=this;this._defaultKeyManager?this._defaultKeyManager.registerKey(n):(this._keysToRegister.push(n),this._loadingDefaultKeyManager||(this._loadingDefaultKeyManager=!0,e.async("core/event/key-manager").then(function(e){var n=t._defaultKeyManager=e.defaultKeyManager;t._keysToRegister.forEach(function(e){n.registerKey(e)}),t._keysToRegister.length=0}).done()))}},unregisterKey:{value:function(e){this._defaultKeyManager&&this._defaultKeyManager.unregisterKey(e)}}},{defaultKeyManager:{get:function(){return l||(l=new c),this._defaultKeyManager?this._defaultKeyManager:l}}})}});